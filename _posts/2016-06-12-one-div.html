---
layout: nil
---

<!doctype html>
<html>
  <head>
    <style>
      body, html, .grid{
        height: 100%;
        width:100%;
        margin:0;
      }
      .grid{
        position:absolute;
	top: 0;
        left:0;
	background-color:#ddd;
	background-image: 
	linear-gradient(rgba(255,255,255,.3) 1px, transparent 1px),
	linear-gradient(90deg, rgba(255,255,255,.3) 1px, transparent 1px);
	background-size:20px 20px, 20px 20px;
	background-position:-2px -2px, -2px -2px, -1px -1px, -1px -1px;
        cursor:pointer;
      }
      .box{
	height:20px;
	width:20px;
	background:transparent;
	position:relative;
      }
      .ctrl {
        position:absolute;
        top:10px;
        right: 10px;
        background:#222;
        padding:1em;
        color: #fff;
	width:25%;
        font-family:'Monaco', monospace;
      }
      label{
        display:block;
      }
      .code{
        background:#eee;
	color:#222;
	padding:1em;
	box-sizing:border-box;
        white-space:normal
      }
    </style>
  </head>
  <body>
    <div class='grid'>
      <div class='box' data-box-shadows=""></div>
    </div>
    <div class='ctrl'>
      <label>pixel size</label>
      <input type='range' min=1 max=50 value=20>
      <label>color</label>
      <input type='color'>
      <pre class='code'></pre>
    </div>
    <script>
      var grid = document.querySelector(".grid")
      var box = document.querySelector(".box")
      var range = document.querySelector("[type='range']")
      var color = document.querySelector("[type='color']")
      var code = document.querySelector(".code")
      var isDragging = false
      range.addEventListener("input", onChange)
      grid.addEventListener("mousedown", onClick)
      grid.addEventListener("mousemove", onMove)
      grid.addEventListener("mouseup", onUp)
      var boxSize = function(){
        return range.value
      }
      function onClick(event){
        isDragging = true
        generateBoxShadows(updateData(event, true))
      }
      function updateData(event, remove){
	var x = (event.offsetX - (event.offsetX % boxSize())) / boxSize()
	var y = (event.offsetY - (event.offsetY % boxSize())) / boxSize()
        var shadows = box.getAttribute("data-box-shadows").split(";")
        var bs = x+','+y+','+ color.value
	box.style.background = ""
	if(shadows.indexOf(bs) != -1 && remove){
	  shadows.splice(shadows.indexOf(bs),1)
	} else if(shadows.indexOf(bs) == -1){
	  shadows.push(bs)
	}
        var nbs = shadows.filter(function(s){
          return s !== ""
	})
        box.setAttribute('data-box-shadows', nbs.join(";"))
	return nbs
      }
      function onMove(event){
        if(!isDragging) return
        generateBoxShadows(updateData(event))
      }
      function onUp(event){
        isDragging = false
      }
      function onChange(event){
        var d = event.target.value
        box.style.width = d + "px"
        box.style.height = d + "px"
        grid.style.backgroundSize = d+"px "+d+"px, "+d+"px "+d+"px"
        var shadows = box.getAttribute("data-box-shadows").split(";")
        generateBoxShadows(shadows)
      }
      function scale(d){
        return parseInt(d) * parseInt(boxSize()) || 0
      }
      function generateBoxShadows( shadows ){
        var styles = shadows.map(function(s){
          var offset = s.split(",")
          var x = offset[0]
          var y = offset[1]
          var color = offset[2] || "transparent"
	  if(x == 0 && y == 0){
	    box.style.background = color
	  }
          return scale(x) + "px " + scale(y) + "px 0 " + color
        }).join(",")
        box.style.boxShadow = styles
	console.log(styles)
        output = outputStyles([
	  'box-shadow: ' + styles + ';',
	  'height: ' + boxSize() + 'px;',
	  'width: ' + boxSize() + 'px;'
	])
	code.innerHTML = ".box{"+output+"}"
      }
      function outputStyles(styles){
        return "<br>" + styles.map(function(style){
     	  return "&nbsp;&nbsp;" + style
	}).join("<br>") + "<br>"
      }
    </script>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
	var t   = document.createElement('script');
	t.type  = 'text/javascript';
	t.async = true;
	t.id    = 'gauges-tracker';
	t.setAttribute('data-site-id', '54521d778bfdf72812001416');
	t.src = '//secure.gaug.es/track.js';
	var s = document.getElementsByTagName('script')[0];
	s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>